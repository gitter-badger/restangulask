<div ng-controller="DetailsController as detail">

 <div ng-if='detail.data'>
  <!-- WITH DATA -->

  <div class="row" ng-hide="detail.data.id">
   <div class="col s12 m10 l10">
    No data...
   </div>
  </div>
  <div class="row" ng-if="detail.data.id">

   <div class="col s12 m9 l9">
  <!-- content -->

      <!-- text -->
      <div
        ng-repeat='(name, rows) in detail.refinedData track by $index'
        ng-if="name !== 'undefined'"
        id="spy{{$index}}" layout-padding
        class="section scrollspy" scrollspy>

<!--
        **{{name}}** and {{rows}}
-->

        <table class='striped responsive-table'>
         <thead>
           <tr>
             <td colspan="2"> <h4> {{name}} </h4> </td>
           </tr>
         </thead>
          <tbody>
            <tr ng-if='value' ng-repeat='(key, value) in rows'>
              <th> {{ key }} </th>
              <td ng-if="name == 'Extrait' && key.indexOf('ero de l') >= 0">
                <b> <i>{{ value }}</i> </b> </td>
              <td ng-if="!(name == 'Extrait' && key.indexOf('ero de l') >= 0)"> {{ value }} </td>
            </tr>
          </tbody>
        </table>
      </div>

      <!-- pages -->
      <div ng-hide='detail.data.images' class="card-panel red darken-4">
        <span class="white-text">
          No images or transcriptions found for this record.
        </span>
      </div>

      <div ng-repeat='image in detail.data.images' id="image{{image.code}}"
        class="section scrollspy" scrollspy>
        <h4> Page {{image.code}} </h4>
        <table class="responsive-table">
          <thead>
            <tr>
              <th>Image</th>
              <th
                ng-if="image.transcriptions.length > 0">Transcription</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="celltop">
                <a href="/zoom/{{ detail.data.id }}/{{ image.code }}" target="_blank">
<!-- NOT WORKING IF TIF -->
                  <img class="responsive-img z-depth-3"
                       tooltipped data-position="right" data-delay="50"
                       data-tooltip="Click to zoom this image"
                      lazy-img="/static/uploads/{{ image.filename }}">
                </a>
              </td>
              <td width='55%' class="celltop"
                ng-if="image.transcriptions.length > 0">

<ul ng-if="image.transcriptions.length > 1"
  class="collapsible popout" data-collapsible="accordion" watch>
<!-- Many transcript -->
    <li ng-repeat="transcript in image.transcriptions track by $index">
        <div class="collapsible-header">Transcript n.{{$index + 1}}</div>
        <div class="collapsible-body transcription flow-text"
            ng-bind-html="image.transcriptions"></div>
    </li>
</ul>


  <div ng-bind-html="detail.test"></div>
<!--
  <span ng-bind="image.transcriptions" > </span>
  class='transcription flow-text z-depth-3'

<!- One transcript ->

<div ng-if="image.transcriptions.length == 1"
  ng-bind-html="image.transcriptions" ></div>
-->

              </td>
            </tr>
          </tbody>
        </table>
      </div>

  <!-- content -->
   </div>

    <div class="col hide-on-small-only m3 l3">
  <!-- Summary -->
      <div pushpin pushpin-offset="1">
      <ul class="section table-of-contents">
        <li
            ng-repeat='(name, row) in detail.refinedData track by $index'
            ng-if="name !== 'undefined'"
            >
          <a href="#spy{{$index}}">
            {{name}}
          </a>
        </li>

        <!-- SEPARATOR -->
        <li> <hr> </li>

        <!-- PREVIOUS PAGE if exists -->
        <li ng-if="detail.previous.link">
            <a href ui-sref="public.details({id: detail.previous.link})"
            ><i>précédent</i>: <u>{{detail.previous.text}}</u></a> </li>

        <!-- SHOULD BE ONLY ONE PAGE -->
        <li ng-repeat='image in detail.data.images'>
          <a href="#image{{image.code}}">
            <i>Image</i>: <b>{{image.code}} </b>
          </a>
        </li>

        <!-- NEXT PAGE if exists -->
        <li ng-if="detail.next.link">
            <a href ui-sref="public.details({id: detail.next.link})"
            ><i>suivant</i>: <u>{{detail.next.text}}</u></a> </li>

      </ul>
     </div>
  <!-- Summary -->
    </div>


  </div> <!-- END OF ROW -->
 </div> <!-- END OF DATA -->

</div>
